<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SM64 Leaderboard com Database e Ranks Autom√°ticos</title>
    <style>
        :root { --bg-color: #121212; --text-color: #e0e0e0; --primary-color: #ffffff; --secondary-color: #b3b3b3; --border-color: #333333; --pending-color: #f39c12; --accent-color: #6200ee; }
        body { background-color: var(--bg-color); color: var(--text-color); font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif; margin: 0; padding: 1rem; }
        header { text-align: center; border-bottom: 1px solid var(--border-color); padding-bottom: 1rem; margin-bottom: 1.5rem; }
        h1, h2 { color: var(--primary-color); }
        nav { margin-top: 1rem; display: flex; justify-content: center; gap: 1.5rem; }
        nav a, .action-button { color: var(--secondary-color); text-decoration: none; font-weight: bold; cursor: pointer; }
        nav a:hover, .action-button:hover { color: var(--primary-color); }
        main { max-width: 900px; margin: 0 auto; }
        .category-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; }
        .category-card { background-color: #1e1e1e; border: 1px solid var(--border-color); border-radius: 8px; padding: 1.5rem; text-align: center; cursor: pointer; transition: transform 0.2s; }
        .category-card:hover { transform: translateY(-5px); }
        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 0.75rem; text-align: left; border-bottom: 1px solid var(--border-color); }
        tr.pending-run td { border-left: 3px solid var(--pending-color); opacity: 0.8; }
        .mod-actions button { background: none; border: 1px solid var(--border-color); color: var(--text-color); cursor: pointer; padding: 4px 8px; margin-right: 5px; border-radius: 4px; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); justify-content: center; align-items: center; }
        .modal-content { background-color: #2a2a2a; padding: 2rem; border-radius: 8px; width: 90%; max-width: 500px; position: relative; }
        .close-btn { position: absolute; top: 10px; right: 15px; font-size: 1.5rem; cursor: pointer; }
        form label { display: block; margin-top: 1rem; }
        form input, form select, form button { width: 100%; padding: 0.75rem; margin-top: 0.5rem; border-radius: 4px; border: 1px solid var(--border-color); background-color: #333; color: var(--text-color); box-sizing: border-box; }
        form button { background-color: var(--accent-color); font-weight: bold; cursor: pointer; }
        .loader { text-align: center; font-size: 1.2em; padding: 2rem; }
    </style>
</head>
<body>
    <header>
        <h1>Mobile Super Mario 64 Speedrun Leaderboard</h1>
        <nav>
            <a onclick="showHomePage()">Home</a>
            <a onclick="showRulesPage()">Regras</a>
        </nav>
        <div style="margin-top: 1rem;">
            <a class="action-button" onclick="openSubmissionModal()">Enviar Run</a>
            <span style="color: var(--border-color); margin: 0 10px;">|</span>
            <a class="action-button" id="moderator-login-link" onclick="loginModerator()">Login Moderador</a>
        </div>
    </header>
    <main id="app-container"></main>

    <div id="submission-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeSubmissionModal()">&times;</span>
            <h2>Enviar Nova Run</h2>
            <form id="submission-form" onsubmit="handleRunSubmission(event)">
                <label for="runner">Runner:</label><input type="text" id="runner" required>
                <label for="category">Categoria:</label><select id="category" required></select>
                <label for="time">Tempo (HH:MM:SS ou MM:SS):</label><input type="text" id="time" required>
                <label for="date">Data:</label><input type="date" id="date" required>
                <label for="videoLink">Link do V√≠deo:</label><input type="url" id="videoLink" required>
                <button type="submit">Enviar para Verifica√ß√£o</button>
            </form>
        </div>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <script>
        // ==============================================================================
        // 1. CONFIGURA√á√ÉO DO FIREBASE
        // ==============================================================================
        const firebaseConfig = {
    apiKey: "AIzaSyCHGM4Bw4w-3SM3ScVCLnLhcCI0ISTB7S0",
    authDomain: "sm64-mobile-leaderboard.firebaseapp.com",
    projectId: "sm64-mobile-leaderboard",
    storageBucket: "sm64-mobile-leaderboard.firebasestorage.app",
    messagingSenderId: "474371344168",
    appId: "1:474371344168:web:a888b644a2a0b04ec9f21d"
  };
        
        // Inicializa o Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ==============================================================================
        // 2. L√ìGICA DO APLICATIVO E RENDERIZA√á√ÉO
        // ==============================================================================
        const appContainer = document.getElementById('app-container');
        let isModerator = false;
        let categoriesCache = [];

        async function showHomePage() {
            appContainer.innerHTML = '<div class="loader">Carregando categorias...</div>';
            try {
                const categoriesCollection = db.collection('categories').orderBy('order');
                const snapshot = await categoriesCollection.get();
                categoriesCache = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

                if (categoriesCache.length === 0) {
                     appContainer.innerHTML = '<h2>Nenhuma categoria encontrada. Abra o console (F12) e execute a fun√ß√£o seedDatabase() para popular os dados.</h2>';
                     return;
                }

                const categoryGrid = document.createElement('div');
                categoryGrid.className = 'category-grid';
                categoryGrid.innerHTML = categoriesCache.map(cat => `
                    <div class="category-card" onclick="showLeaderboard('${cat.id}', '${cat.name}')">
                        <h2>${cat.name}</h2>
                    </div>
                `).join('');
                appContainer.innerHTML = '';
                appContainer.appendChild(categoryGrid);
            } catch (error) {
                console.error("Erro ao buscar categorias:", error);
                appContainer.innerHTML = `<h2>Ocorreu um erro ao conectar ao banco de dados. Verifique sua configura√ß√£o do Firebase e as regras de seguran√ßa.</h2>`;
            }
        }

        async function showLeaderboard(categoryId, categoryName) {
            appContainer.innerHTML = `<div class="loader">Carregando runs para ${categoryName}...</div>`;
            const runsCollection = db.collection('categories').doc(categoryId).collection('runs').orderBy('rank');
            
            runsCollection.onSnapshot(snapshot => {
                let runsHtml = '';
                snapshot.forEach(doc => {
                    const run = { id: doc.id, ...doc.data() };
                    // Formata a data para um formato leg√≠vel
                    const runDate = run.date ? new Date(run.date + 'T00:00:00').toLocaleDateString() : 'N/A';
                    
                    runsHtml += `
                        <tr class="${!run.verified ? 'pending-run' : ''}">
                            <td>${run.rank}</td>
                            <td>${run.runner}</td>
                            <td>${run.time}</td>
                            <td>${runDate}</td>
                            <td>${run.videoLink ? `<a href="${run.videoLink}" target="_blank">Link</a>` : 'N/A'}</td>
                            <td>${run.notes || ''}</td>
                            ${isModerator ? `
                                <td class="mod-actions">
                                    ${!run.verified ? `<button onclick="verifyRun('${categoryId}', '${run.id}')">‚úÖ</button>` : ''}
                                    <button onclick="deleteRun('${categoryId}', '${run.id}', '${categoryName}')">üóëÔ∏è</button>
                                </td>
                            ` : ''}
                        </tr>
                    `;
                });

                appContainer.innerHTML = `
                    <h2 class="leaderboard-title">${categoryName}</h2>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th><th>Runner</th><th>Tempo</th><th>Data</th><th>V√≠deo</th><th>Notas</th>
                                    ${isModerator ? '<th>A√ß√µes</th>' : ''}
                                </tr>
                            </thead>
                            <tbody>${runsHtml}</tbody>
                        </table>
                    </div>
                `;
            }, error => {
                console.error("Erro ao buscar runs: ", error);
                appContainer.innerHTML = `<h2>Ocorreu um erro ao carregar o leaderboard.</h2>`;
            });
        }
        
        // ... (Fun√ß√£o showRulesPage pode ser adicionada aqui)

        // ==============================================================================
        // 3. L√ìGICA DE RANK AUTOM√ÅTICO E MODERA√á√ÉO
        // ==============================================================================
        function parseTimeToSeconds(timeStr) {
            const parts = String(timeStr).split(':').map(Number);
            if (parts.length === 3) return parts[0] * 3600 + parts[1] * 60 + parts[2];
            if (parts.length === 2) return parts[0] * 60 + parts[1];
            return parts[0] || 0;
        }

        async function recalculateAndSaveRanks(categoryId) {
            console.log(`Recalculando ranks para a categoria ${categoryId}...`);
            const runsRef = db.collection('categories').doc(categoryId).collection('runs');
            const snapshot = await runsRef.get();

            const runs = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            
            runs.sort((a, b) => parseTimeToSeconds(a.time) - parseTimeToSeconds(b.time));

            const batch = db.batch();
            runs.forEach((run, index) => {
                const newRank = index + 1;
                if (run.rank !== newRank) {
                    const docRef = runsRef.doc(run.id);
                    batch.update(docRef, { rank: newRank });
                }
            });

            await batch.commit();
            console.log("Ranks recalculados e salvos!");
        }

        function loginModerator() {
            if (prompt("Digite a senha:") === "5555") {
                isModerator = true;
                alert("Login bem-sucedido!");
                showHomePage();
            } else {
                alert("Senha incorreta.");
            }
        }
        
        async function verifyRun(categoryId, runId) {
            if (!isModerator) return;
            const modName = prompt("Verificar como (seu nome):");
            if (modName) {
                const runRef = db.collection('categories').doc(categoryId).collection('runs').doc(runId);
                await runRef.update({ verified: true, verifiedBy: modName });
            }
        }

        async function deleteRun(categoryId, runId, categoryName) {
            if (!isModerator || !confirm("Tem certeza?")) return;
            await db.collection('categories').doc(categoryId).collection('runs').doc(runId).delete();
            await recalculateAndSaveRanks(categoryId);
        }
        
        async function openSubmissionModal() {
            const categorySelect = document.getElementById('category');
            if (categoriesCache.length === 0) await showHomePage();
            categorySelect.innerHTML = categoriesCache.map(c => `<option value="${c.id}">${c.name}</option>`).join('');
            document.getElementById('submission-modal').style.display = 'flex';
        }
        function closeSubmissionModal() {
            document.getElementById('submission-modal').style.display = 'none';
        }

        async function handleRunSubmission(event) {
            event.preventDefault();
            const form = event.target;
            const categoryId = form.category.value;
            const newRun = {
                runner: form.runner.value,
                time: form.time.value,
                date: form.date.value,
                videoLink: form.videoLink.value,
                rank: 0,
                verified: false,
                verifiedBy: "",
                notes: ""
            };
            
            await db.collection('categories').doc(categoryId).collection('runs').add(newRun);
            await recalculateAndSaveRanks(categoryId);
            
            alert("Run enviada para verifica√ß√£o!");
            closeSubmissionModal();
            form.reset();
        }

        // ==============================================================================
        // 4. FUN√á√ÉO PARA POPULAR O BANCO DE DADOS (USAR UMA VEZ)
        // ==============================================================================
        async function seedDatabase() {
             const seedData = {
              "title": "Mobile Super Mario 64 Speedrun Leaderboard",
              "discordLink": "https://discord.gg/28sytjXMxK",
              "moderators": ["Ami", "Major", "Chillo", "Positive_Pan"],
              "rules": [],
              "categories": [
                {
                  "name": "0 Star",
                  "runs": [
                    { "rank": 1, "runner": "Jugo de naranja", "time": "7:16", "date": "2025-07-30", "videoLink": "https://youtu.be/zDdfwgc8t8k?si=Le-NwfGysIQyt1vB", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 2, "runner": "WRandY", "time": "10:15", "date": "2024-09-28", "videoLink": "https://b23.tv/XDeuXLw", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 3, "runner": "Littlezombie", "time": "14:31", "date": "2024-04-12", "videoLink": "https://youtu.be/zCgTy2QcsPE?si=EmalQqZh68fOX20t", "notes": "", "verified": true, "verifiedBy": "Ami" }
                  ]
                },
                {
                  "name": "1 Star",
                  "runs": [
                    { "rank": 1, "runner": "Jugo de naranja", "time": "7:43", "date": "2025-06-05", "videoLink": "https://youtu.be/s3-tZkqCXv8?si=bdEoIRBKXuPEPjbe", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 2, "runner": "AmiDoesRuns", "time": "8:17", "date": "2024-08-28", "videoLink": "https://youtu.be/nqf5jH5IWVM?si=Z-Ud_o8JnCPoQGRe", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 3, "runner": "Nisi Sm64", "time": "8:27", "date": "2024-08-27", "videoLink": "https://youtu.be/uaQ9bdKOI6E?si=J1nHvTxSzU_m_tWE", "notes": "", "verified": true, "verifiedBy": "Positive_Pan" },
                    { "rank": 4, "runner": "Major", "time": "9:01", "date": "2025-03-13", "videoLink": "https://youtu.be/GC06TvsrK1o?si=FKs4ytEyrigzX4WY", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 5, "runner": "Littlezombie", "time": "10:27", "date": "2024-04-05", "videoLink": "https://youtu.be/NDV64IY1Mx4?si=QhatiiG2A5--YZ_l", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 6, "runner": "three yuan", "time": "12:48", "date": "2025-02-02", "videoLink": "https://b23.tv/g3MXmHB", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 7, "runner": "Agu", "time": "13:02", "date": "2025-03-14", "videoLink": "https://youtu.be/R9wDj90VI40?si=z62FJGce3zX0Sbo2", "notes": "", "verified": true, "verifiedBy": "Chillo" }
                  ]
                },
                {
                  "name": "16 Star No LBLJ",
                  "runs": [
                    { "rank": 1, "runner": "AmiDoesRuns", "time": "15:56", "date": "2025-06-05", "videoLink": "https://youtu.be/nEfVP4sdTZ8?si=Fg6BkO_X0MLgvOPf", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 2, "runner": "Major", "time": "16:21", "date": "2025-06-12", "videoLink": "https://youtu.be/-I-3JvSGqAo?si=biZd3zO--7L8XkBy", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 3, "runner": "Nisi Sm64", "time": "16:40", "date": "2024-08-13", "videoLink": "https://youtu.be/UJHeDVGfS6M?si=Vtx5njPEAJQP1dTJ", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 4, "runner": "Positive_Pan", "time": "16:59", "date": "2025-04-19", "videoLink": "https://youtu.be/Qgl8iEg9z7c?si=gaVIBfvoxj2_NLEP", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 5, "runner": "stEv3900", "time": "17:03", "date": "2024-12-12", "videoLink": "https://youtu.be/4HsUPhzMj64?si=CHSQ83ixWjG9isKZ", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 6, "runner": "Chillo", "time": "17:33", "date": "2025-07-13", "videoLink": "https://youtu.be/W9k1_BhNDGM?si=3szQGilzSSMj3Ouj", "notes": "", "verified": true, "verifiedBy": "Major" },
                    { "rank": 7, "runner": "Golden King", "time": "17:54", "date": "2025-08-12", "videoLink": "https://b23.tv/8y3DQJP", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 8, "runner": "WRandY", "time": "18:07", "date": "2025-07-16", "videoLink": "https://b23.tv/LA02MwR", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 9, "runner": "SpeedVortex", "time": "18:23", "date": "2025-01-02", "videoLink": "https://youtu.be/iJXFBFKgrjE?si=36flkxZd9jt_Xi1d", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 10, "runner": "yusosekc", "time": "18:39", "date": "2020-01-02", "videoLink": "https://www.twitch.tv/videos/529580971", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 11, "runner": "Mack64", "time": "18:55", "date": "2024-09-01", "videoLink": "https://youtu.be/NJopXYn_INQ?si=YSPGMUNSKGMHZAKZ", "notes": "", "verified": true, "verifiedBy": "Major" },
                    { "rank": 12, "runner": "Mario104", "time": "19:16", "date": "2025-02-04", "videoLink": "https://b23.tv/2KdkHDI", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 13, "runner": "three yuan", "time": "19:45", "date": "2024-10-11", "videoLink": "https://b23.tv/lg3wrCg", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 14, "runner": "Jared64", "time": "19:48", "date": "2025-03-05", "videoLink": "https://youtu.be/41q-sMply_Y?feature=shared", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 15, "runner": "Themariospeedgamer", "time": "19:50", "date": "2020-06-16", "videoLink": "https://youtu.be/Sqs0HBOeqkY?si=5bqnU8jrDJNrzX0P", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 16, "runner": "Arthur Duarte tui", "time": "20:21", "date": "2024-01-01", "videoLink": null, "notes": "Vid Unavailable (Positive_Pan)", "verified": false, "verifiedBy": "" },
                    { "rank": 17, "runner": "Bageler", "time": "20:34", "date": "2025-08-19", "videoLink": "https://youtu.be/hqA_-Oflnil?si=jZ79FoiF_jK0qxFR", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 18, "runner": "Volt", "time": "20:55", "date": "2020-07-06", "videoLink": "https://youtu.be/C-w6FHKdM-g?si=skkU1LwxztM66a2D", "notes": "Retimed to 20:55 from 20:56", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 19, "runner": "haze129", "time": "20:58", "date": "2017-10-10", "videoLink": "https://youtu.be/BqIRI1P_x8c?si=AOoqWeiNrshdCfFW", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 20, "runner": "Majoog", "time": "21:24", "date": "2019-11-12", "videoLink": "https://youtu.be/ysZexUz2LOg?si=Lrs4OOCj4mB_Z5oG", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 21, "runner": "Ayushman Singh", "time": "21:26", "date": "2021-09-02", "videoLink": "https://youtu.be/IU6NHeRvneQ?si=-oH_Su0N1t1YmRIN", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 22, "runner": "Littlezombie", "time": "21:32", "date": "2024-03-17", "videoLink": "https://youtu.be/BMBNuCBgiMI?si=pWUCSQ9WSV7SHDRJ", "notes": "", "verified": true, "verifiedBy": "Positive_Pan" },
                    { "rank": 23, "runner": "JacobJY", "time": "21:32", "date": "2024-10-02", "videoLink": "https://b23.tv/FtpV0VP", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 24, "runner": "pito", "time": "22:23", "date": "2025-04-05", "videoLink": "https://www.youtube.com/watch?v=garagg84Ovc", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 25, "runner": "Rian Studios", "time": "22:33", "date": "2021-12-19", "videoLink": "https://youtu.be/v9oBpvQRX2w?si=IsEtwVDQhosKigrj", "notes": "", "verified": true, "verifiedBy": "Positive_Pan" },
                    { "rank": 26, "runner": "Sm64 Speedruns", "time": "22:43", "date": "2019-09-04", "videoLink": "https://youtu.be/B47Rw64EZTI?si=u2Gcvb5uGtXzdLew", "notes": "", "verified": true, "verifiedBy": "Positive_Pan" },
                    { "rank": 27, "runner": "7887Gamer Boi64", "time": "23:21", "date": "2022-07-31", "videoLink": "https://youtu.be/lqFD36s0fzA?si=nQFpFm1BGm_k7cuY", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 28, "runner": "GCDobers", "time": "23:27", "date": "2025-02-24", "videoLink": "https://youtu.be/4dq9GFYraHA?si=ev4nXZud8SA_q22j", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 29, "runner": "Jugo de naranja", "time": "23:54", "date": "2024-08-19", "videoLink": "https://www.youtube.com/watch?v=_AT8ioy40Sg", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 30, "runner": "Baxiba", "time": "24:29", "date": "2023-02-01", "videoLink": "https://b23.tv/HMCz9yF", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 31, "runner": "Denz CL", "time": "24:31", "date": "2025-04-11", "videoLink": "https://www.youtube.com/watch?v=CliwPYvufx0", "notes": "Time Not Started Upon Reset (Ami)", "verified": false, "verifiedBy": "" },
                    { "rank": 32, "runner": "ace2.4.6", "time": "24:45", "date": "2023-08-22", "videoLink": "https://youtu.be/USKYtrAX5CU?si=_C3SSV1yK_f56mys", "notes": "Run starts at 2:01", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 33, "runner": "Kimlu3123", "time": "25:06", "date": "2018-05-08", "videoLink": "https://youtu.be/t2wkvdFagB0?si=SUDFOZEt499QZDON", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 34, "runner": "KaMa2", "time": "25:35", "date": "2019-08-21", "videoLink": "https://youtu.be/VV8e5WKn5LI?si=gtBtlYHgBNLUXBCE", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 35, "runner": "BonBin", "time": "25:57", "date": "2020-12-26", "videoLink": "https://youtu.be/N2HL9spzpEU?si=nKN2Z07bqCj2rnml", "notes": "Time Not Started Upon Reset (Positive_Pan)", "verified": false, "verifiedBy": "" },
                    { "rank": 36, "runner": "Ericky", "time": "26:02", "date": "2024-10-06", "videoLink": "https://youtu.be/Rg-jPe7umO4?si=Y7jRFYVHdOozZ5Kv", "notes": "Time Not Started Upon Reset (Chillo)", "verified": false, "verifiedBy": "" },
                    { "rank": 37, "runner": "Femboycat", "time": "26:44", "date": "2025-08-23", "videoLink": "https://youtu.be/fc2reOV58Gs?si=fbayPsHDoDxiRamU", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 38, "runner": "zeldaglitchgamer", "time": "28:06", "date": "2017-07-09", "videoLink": "https://youtu.be/mSXqn_hqW48?si=JC-4Er9s5w0h7Cuv", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 39, "runner": "Igorski", "time": "28:09", "date": "2023-10-01", "videoLink": "https://youtu.be/tB7nnePTTxc?si=Zna_XF04Qv4CchX2", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 40, "runner": "YatoYtUwu", "time": "28:48", "date": "2022-08-20", "videoLink": "https://youtu.be/vCvFPloB6zU?si=spXnT0Ob9UB1N8ev", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 41, "runner": "Cosmic64", "time": "28:56", "date": "2024-09-02", "videoLink": "https://www.youtube.com/watch?v=4139bkEpzRA", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 42, "runner": "ssssaasc", "time": "29:40", "date": "2023-01-09", "videoLink": "https://b23.tv/oS1Kn1z", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 43, "runner": "Iv√°n P√©rez Guti√©rrez", "time": "30:25", "date": "2020-07-09", "videoLink": "https://youtu.be/2eArW4KqBW8?si=CCRkMagfZuGKXSXm", "notes": "", "verified": true, "verifiedBy": "Positive_Pan" },
                    { "rank": 44, "runner": "Speedy =)", "time": "31:24", "date": "2021-10-20", "videoLink": "https://www.youtube.com/live/aRj7A7oAeEw", "notes": "Run starts at 16:51", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 45, "runner": "pan con queso", "time": "35:18", "date": "2020-08-14", "videoLink": "https://youtu.be/1EeeqGkWD20?si=V2qP1G30pdTlewud", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 46, "runner": "HeZa Games", "time": "36:22", "date": "2023-10-25", "videoLink": "https://youtu.be/bNkgVswqZOQ?si=cfiCPDuruE00T4Rv", "notes": "Time Not Started Upon Reset (Ami)", "verified": false, "verifiedBy": "" },
                    { "rank": 47, "runner": "Jonriel Besinio", "time": "39:05", "date": "2021-08-22", "videoLink": "https://youtu.be/Pg0k3jQj38g?si=dIWXWYKa7UYeSctG", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 48, "runner": "MarioCrackYT", "time": "43:21", "date": "2022-12-29", "videoLink": "https://youtu.be/xoxEljNIMSw?si=TpDazjZHZ0qxdvcu", "notes": "", "verified": true, "verifiedBy": "Ami" }
                  ]
                },
                {
                  "name": "16 Star LBLJ",
                  "runs": [
                    { "rank": 1, "runner": "Major", "time": "16:52", "date": "2025-03-17", "videoLink": "https://youtu.be/q8sN_j7Az_M?si=g1-N1JiuFSFPvjVR", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 2, "runner": "AmiDoesRuns", "time": "17:31", "date": "2024-07-14", "videoLink": "https://youtu.be/L4JYeglySJ0?si=Epb5hhPc155e2xm", "notes": "", "verified": true, "verifiedBy": "Positive_Pan" },
                    { "rank": 3, "runner": "Positive_Pan", "time": "18:05", "date": "2024-07-05", "videoLink": "https://youtu.be/8FhL-QL52-E?si=SHoZPdEiF_9mdfi0", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 4, "runner": "three yuan", "time": "18:44", "date": "2025-01-29", "videoLink": "https://b23.tv/jNjQdQt", "notes": "", "verified": true, "verifiedBy": "" }
                  ]
                },
                {
                  "name": "70 Star",
                  "runs": [
                    { "rank": 1, "runner": "AmiDoesRuns", "time": "50:07", "date": "2025-07-28", "videoLink": "https://www.twitch.tv/videos/2527370259", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 2, "runner": "Major", "time": "51:50", "date": "2025-07-10", "videoLink": "https://youtu.be/yjsSmklbmYQ?si=kfaBXyvB60Sqxs7q", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 3, "runner": "stEv3900", "time": "56:11", "date": "2024-03-20", "videoLink": "https://youtu.be/Ma_uaL5iHTE?si=uov6wqLLWFXw42Sz", "notes": "", "verified": true, "verifiedBy": "Positive_Pan" },
                    { "rank": 4, "runner": "Nisi sm64", "time": "57:35", "date": "2022-05-20", "videoLink": "https://youtu.be/ev8eMiK9D_Q?si=1erv7uk3ieM3wMYv", "notes": "", "verified": true, "verifiedBy": "Positive_Pan" },
                    { "rank": 5, "runner": "Chillo", "time": "58:42", "date": "2025-07-25", "videoLink": "https://www.youtube.com/watch?v=_AAOJT-HSrA", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 6, "runner": "Golden King", "time": "59:23", "date": "2025-07-29", "videoLink": "https://b23.tv/IHCVfWW", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 7, "runner": "Speedvortex", "time": "59:35", "date": "2024-09-21", "videoLink": "https://youtu.be/E81CAVI28hk?si=g2FcHBLPjCw-Nh4", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 8, "runner": "Positive_Pan", "time": "59:59", "date": "2025-01-10", "videoLink": "https://youtu.be/00BzFavjWjA?si=D2RE6ZN6N-7fJrKr", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 9, "runner": "jared64", "time": "1:04:25", "date": "2025-02-24", "videoLink": "https://youtu.be/JYFqxvrDBfl?feature=shared", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 10, "runner": "yusosekc", "time": "1:05:33", "date": "2020-01-04", "videoLink": "https://www.twitch.tv/videos/530596218", "notes": "", "verified": true, "verifiedBy": "Ami" },
                    { "rank": 11, "runner": "Jugo de naranja", "time": "1:27:03", "date": "2024-08-14", "videoLink": null, "notes": "No Vid Link (Chillo)", "verified": false, "verifiedBy": "" }
                  ]
                },
                {
                  "name": "120 Star",
                  "runs": [
                    { "rank": 1, "runner": "AmiDoesRuns", "time": "1:56:17", "date": "2025-06-01", "videoLink": "https://youtu.be/zVuYX8Sd3uY?si=tkjA7ZJA4Q2840dp", "notes": "", "verified": true, "verifiedBy": "Chillo" },
                    { "rank": 2, "runner": "SpeedVortex", "time": "2:22:51", "date": "2024-04-19", "videoLink": "https://youtu.be/5UxnEsogfks?si=Ly6lXe0LbH7oaToR", "notes": "", "verified": true, "verifiedBy": "Ami" }
                  ]
                }
              ]
            };
             
             console.log("Iniciando a popula√ß√£o do banco de dados... Isso pode levar um momento.");

             // --- IN√çCIO DA CORRE√á√ÉO ---
             for (let index = 0; index < seedData.categories.length; index++) {
                 const category = seedData.categories[index];
             // --- FIM DA CORRE√á√ÉO ---

                 const categoryRef = await db.collection('categories').add({ name: category.name, order: index + 1 });
                 console.log(`Categoria '${category.name}' criada.`);
                 for (const run of category.runs) {
                     await db.collection('categories').doc(categoryRef.id).collection('runs').add(run);
                 }
                 console.log(`${category.runs.length} runs adicionadas para ${category.name}.`);
                 await recalculateAndSaveRanks(categoryRef.id);
             }
             
             console.log("POPULA√á√ÉO DO BANCO DE DADOS CONCLU√çDA!");
             showHomePage();
        }
        
        // ==============================================================================
        // 5. INICIALIZA√á√ÉO
        // ==============================================================================
        document.addEventListener('DOMContentLoaded', showHomePage);

    </script>
</body>
</html>